import React, { useState } from 'react';
import Head from 'next/head';
import styles from './BestSellers.module.css';
import OptimizedImage from '@/components/common/OptimizedImage';

interface Product {
    id: number;
    name: string;
    price: number;
    originalPrice?: number;
    image: string;
    sales: number;
    rating: number;
    reviews: number;
    category: string;
    badge?: string;
}

const BestSellers: React.FC = () => {
    const [selectedCategory, setSelectedCategory] = useState('all');
    const [sortBy, setSortBy] = useState('sales');

    const bestSellerProducts: Product[] = [
        {
            id: 1,
            name: 'Î≤†Ïä§Ìä∏ÏÖÄÎü¨ ÏõêÌîºÏä§',
            price: 89900,
            originalPrice: 129900,
            image: 'https://image.mustit.co.kr/lib/upload/admin/specialSale/6c646f20abbdb77a7d90bd4fd7c4a5d1.jpg',
            sales: 1250,
            rating: 4.8,
            reviews: 324,
            category: 'dress',
            badge: '1ÏúÑ'
        },
        {
            id: 2,
            name: 'Ïù∏Í∏∞ Ïä§ÎãàÏª§Ï¶à',
            price: 129900,
            image: 'https://image.mustit.co.kr/lib/upload/admin/specialSale/6c646f20abbdb77a7d90bd4fd7c4a5d1.jpgg',
            sales: 980,
            rating: 4.7,
            reviews: 256,
            category: 'shoes',
            badge: '2ÏúÑ'
        },
        {
            id: 3,
            name: 'ÌÅ¥ÎûòÏãù Î∏îÎ†àÏù¥Ï†Ä',
            price: 159900,
            originalPrice: 199900,
            image: 'https://image.mustit.co.kr/lib/upload/admin/specialSale/6c646f20abbdb77a7d90bd4fd7c4a5d1.jpg',
            sales: 850,
            rating: 4.6,
            reviews: 189,
            category: 'jacket',
            badge: '3ÏúÑ'
        },
        {
            id: 4,
            name: 'Îç∞Îãò Ï≤≠Î∞îÏßÄ',
            price: 79900,
            image: 'https://image.mustit.co.kr/lib/upload/admin/specialSale/6c646f20abbdb77a7d90bd4fd7c4a5d1.jpg',
            sales: 750,
            rating: 4.5,
            reviews: 234,
            category: 'pants'
        },
        {
            id: 5,
            name: 'Ï∫êÏãúÎØ∏Ïñ¥ Ïä§Ïõ®ÌÑ∞',
            price: 189900,
            originalPrice: 259900,
            image: 'https://image.mustit.co.kr/lib/upload/admin/specialSale/6c646f20abbdb77a7d90bd4fd7c4a5d1.jpg',
            sales: 680,
            rating: 4.9,
            reviews: 145,
            category: 'top'
        },
        {
            id: 6,
            name: 'Ïã§ÌÅ¨ Î∏îÎùºÏö∞Ïä§',
            price: 119900,
            image: 'https://image.mustit.co.kr/lib/upload/admin/specialSale/6c646f20abbdb77a7d90bd4fd7c4a5d1.jpg',
            sales: 620,
            rating: 4.4,
            reviews: 178,
            category: 'top'
        },
        {
            id: 7,
            name: 'Î†àÎçî Ìï∏ÎìúÎ∞±',
            price: 249900,
            originalPrice: 329900,
            image: 'https://image.mustit.co.kr/lib/upload/admin/specialSale/6c646f20abbdb77a7d90bd4fd7c4a5d1.jpg',
            sales: 580,
            rating: 4.8,
            reviews: 92,
            category: 'bag'
        },
        {
            id: 8,
            name: 'Ìä∏Î†åÏπò ÏΩîÌä∏',
            price: 299900,
            image: 'https://image.mustit.co.kr/lib/upload/admin/specialSale/6c646f20abbdb77a7d90bd4fd7c4a5d1.jpg',
            sales: 520,
            rating: 4.7,
            reviews: 156,
            category: 'jacket'
        }
    ];

    const categories = [
        { value: 'all', label: 'Ï†ÑÏ≤¥' },
        { value: 'dress', label: 'ÏõêÌîºÏä§' },
        { value: 'top', label: 'ÏÉÅÏùò' },
        { value: 'pants', label: 'Î∞îÏßÄ' },
        { value: 'jacket', label: 'ÏïÑÏö∞ÌÑ∞' },
        { value: 'shoes', label: 'Ïã†Î∞ú' },
        { value: 'bag', label: 'Í∞ÄÎ∞©' }
    ];

    const sortOptions = [
        { value: 'sales', label: 'ÌåêÎß§ÎüâÏàú' },
        { value: 'price-low', label: 'ÎÇÆÏùÄ Í∞ÄÍ≤©Ïàú' },
        { value: 'price-high', label: 'ÎÜíÏùÄ Í∞ÄÍ≤©Ïàú' },
        { value: 'rating', label: 'ÌèâÏ†êÏàú' }
    ];

    const getFilteredAndSortedProducts = () => {
        let filtered = selectedCategory === 'all'
            ? bestSellerProducts
            : bestSellerProducts.filter(product => product.category === selectedCategory);

        return filtered.sort((a, b) => {
            switch (sortBy) {
                case 'sales':
                    return b.sales - a.sales;
                case 'price-low':
                    return a.price - b.price;
                case 'price-high':
                    return b.price - a.price;
                case 'rating':
                    return b.rating - a.rating;
                default:
                    return 0;
            }
        });
    };

    const formatPrice = (price: number) => {
        return price.toLocaleString() + 'Ïõê';
    };

    const renderStars = (rating: number) => {
        const stars = [];
        const fullStars = Math.floor(rating);
        const hasHalfStar = rating % 1 !== 0;

        for (let i = 0; i < fullStars; i++) {
            stars.push(<span key={i} className={styles.star}>‚òÖ</span>);
        }
        if (hasHalfStar) {
            stars.push(<span key="half" className={styles.halfStar}>‚òÖ</span>);
        }
        for (let i = stars.length; i < 5; i++) {
            stars.push(<span key={i} className={styles.emptyStar}>‚òÜ</span>);
        }
        return stars;
    };

    return (
        <div className={styles.container}>
            <Head>
                <title>Î≤†Ïä§Ìä∏ÏÖÄÎü¨ - StyleShop</title>
                <meta name="description" content="Í∞ÄÏû• ÎßéÏù¥ ÌåêÎß§ÎêòÎäî Ïù∏Í∏∞ ÏÉÅÌíàÎì§ÏùÑ ÎßåÎÇòÎ≥¥ÏÑ∏Ïöî." />
            </Head>

            <div className={styles.header}>
                <h1>Î≤†Ïä§Ìä∏ÏÖÄÎü¨</h1>
                <p>Í∞ÄÏû• Ïù∏Í∏∞ ÏûàÎäî ÏÉÅÌíàÎì§ÏùÑ ÎßåÎÇòÎ≥¥ÏÑ∏Ïöî</p>
            </div>

            <div className={styles.filters}>
                <div className={styles.categoryFilter}>
                    <label>Ïπ¥ÌÖåÍ≥†Î¶¨</label>
                    <div className={styles.categoryButtons}>
                        {categories.map(category => (
                            <button
                                key={category.value}
                                className={`${styles.categoryButton} ${selectedCategory === category.value ? styles.active : ''
                                    }`}
                                onClick={() => setSelectedCategory(category.value)}
                            >
                                {category.label}
                            </button>
                        ))}
                    </div>
                </div>

                <div className={styles.sortFilter}>
                    <label>Ï†ïÎ†¨</label>
                    <select
                        value={sortBy}
                        onChange={(e) => setSortBy(e.target.value)}
                        className={styles.sortSelect}
                    >
                        {sortOptions.map(option => (
                            <option key={option.value} value={option.value}>
                                {option.label}
                            </option>
                        ))}
                    </select>
                </div>
            </div>

            <div className={styles.productGrid}>
                {getFilteredAndSortedProducts().map((product) => (
                    <div key={product.id} className={styles.productCard}>
                        <div className={styles.productImage}>
                            <OptimizedImage
                                src={product.image}
                                alt={product.name}
                                width={500}
                                height={500}
                                className={styles.image}
                            />
                            {product.badge && (
                                <span className={styles.badge}>{product.badge}</span>
                            )}
                        </div>
                        <div className={styles.productInfo}>
                            <h3 className={styles.productName}>{product.name}</h3>
                            <div className={styles.priceContainer}>
                                {product.originalPrice && (
                                    <span className={styles.originalPrice}>
                                        {formatPrice(product.originalPrice)}
                                    </span>
                                )}
                                <span className={styles.price}>
                                    {formatPrice(product.price)}
                                </span>
                            </div>
                            <div className={styles.rating}>
                                <div className={styles.stars}>
                                    {renderStars(product.rating)}
                                </div>
                                <span className={styles.ratingText}>
                                    {product.rating} ({product.reviews}Í∞ú Î¶¨Î∑∞)
                                </span>
                            </div>
                            <div className={styles.salesInfo}>
                                <span className={styles.salesCount}>
                                    üî• {product.sales}Í∞ú ÌåêÎß§
                                </span>
                            </div>
                            <button className={styles.addToCartButton}>
                                Ïû•Î∞îÍµ¨Îãà Îã¥Í∏∞
                            </button>
                        </div>
                    </div>
                ))}
            </div>

            <div className={styles.loadMore}>
                <button className={styles.loadMoreButton}>
                    Îçî ÎßéÏùÄ ÏÉÅÌíà Î≥¥Í∏∞
                </button>
            </div>

            <div className={styles.infoSection}>
                <h3>Î≤†Ïä§Ìä∏ÏÖÄÎü¨ ÏÑ†Ï†ï Í∏∞Ï§Ä</h3>
                <div className={styles.infoGrid}>
                    <div className={styles.infoCard}>
                        <h4>üìä ÌåêÎß§Îüâ</h4>
                        <p>ÏµúÍ∑º 30ÏùºÍ∞Ñ ÌåêÎß§ÎüâÏùÑ Í∏∞Ï§ÄÏúºÎ°ú ÏÑ†Ï†ï</p>
                    </div>
                    <div className={styles.infoCard}>
                        <h4>‚≠ê Í≥†Í∞ùÎßåÏ°±ÎèÑ</h4>
                        <p>ÌèâÏ†ê 4.0 Ïù¥ÏÉÅ ÏÉÅÌíàÎßå ÏÑ†Î≥Ñ</p>
                    </div>
                    <div className={styles.infoCard}>
                        <h4>üîÑ Ïû¨Íµ¨Îß§Ïú®</h4>
                        <p>ÎÜíÏùÄ Ïû¨Íµ¨Îß§Ïú®ÏùÑ Î≥¥Ïù¥Îäî ÏÉÅÌíà</p>
                    </div>
                    <div className={styles.infoCard}>
                        <h4>üìà Ìä∏Î†åÎìú</h4>
                        <p>ÌòÑÏû¨ Ìä∏Î†åÎìúÎ•º Î∞òÏòÅÌïú Ïù∏Í∏∞ ÏÉÅÌíà</p>
                    </div>
                </div>
            </div>
        </div>
    );
};

export default BestSellers;

